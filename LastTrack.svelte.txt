<script>
  import { fade } from "svelte/transition";
  async function getTrack() {
    const res = await fetch("/music");
    const data = await res.json();
    if (res.ok) {
      return data;
    } else {
      throw new Error(data);
    }
  }
</script>

{#await getTrack() then lastTrack}
  <div class="content" in:fade>
    <p>i just listened to:</p>
    <div class="last_track">
      <img src={lastTrack.albumArt} alt="" />
      <div class="songinfo">
        <p>{lastTrack.artist} - {lastTrack.trackName}</p>
        <p class="album">{lastTrack.album}</p>
      </div>
    </div>
  </div>
{/await}

<style>
  .content {
    margin-top: 1rem;
  }
  .content > p {
    font-size: 0.7rem;
    opacity: 75%;
  }
  .last_track {
    font-size: 0.8rem;
    display: flex;

    align-items: center;
    gap: 1rem;
    border: 1px solid var(--fg);
    width: fit-content;
    padding-right: 1rem;
  }
  .last_track img {
    width: 48px;
    height: 48px;
  }
  .songinfo {
    display: flex;
    flex-direction: column;
  }
  .album {
    font-size: 0.7rem;
    opacity: 75%;
  }
</style>
